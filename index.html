<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Client-Side Download Utility</title>
    <style>
        body { font-family: Arial, sans-serif; display: flex; flex-direction: column; align-items: center; padding-top: 50px; }
        button { padding: 10px 20px; font-size: 16px; cursor: pointer; background-color: #007bff; color: white; border: none; border-radius: 5px; }
    </style>
</head>
<body>

    <h1>Download Generator</h1>
    <p>This script generates content locally and forces the browser to download it.</p>
    <button id="downloadButton">Download Custom Configuration File (config.json)</button>

    <script>
        /**
         * PROFESSIONAL CLIENT-SIDE DOWNLOAD HANDLER
         * Generates content locally, wraps it in a Blob, and triggers a download
         * using the temporary URL and anchor element technique.
         *
         * @param {string} filename - The desired name for the downloaded file.
         * @param {string} content - The string content to be written to the file.
         * @param {string} mimeType - The MIME type (e.g., 'application/json', 'text/plain').
         */
        function downloadFile(filename, content, mimeType) {
            if (!content || !filename) {
                console.error("Content and filename are required.");
                return;
            }

            // 1. Create a Blob object from the content string
            const blob = new Blob([content], { type: mimeType });

            // 2. Create a temporary URL for the Blob
            const url = URL.createObjectURL(blob);

            // 3. Create a hidden anchor element (<a>)
            const a = document.createElement('a');
            a.style.display = 'none';
            
            // 4. Set attributes to initiate the download
            a.href = url;
            // The 'download' attribute forces the browser to treat this URL as a download
            a.download = filename; 

            // 5. Append, click, and clean up
            document.body.appendChild(a);
            a.click(); // Programmatically click the link

            // 6. Cleanup resources
            document.body.removeChild(a);
            URL.revokeObjectURL(url); // Release the memory occupied by the blob URL
        }

        // --- Event Listener ---
        document.getElementById('downloadButton').addEventListener('click', () => {
            const data = {
                api_version: "1.2.0",
                environment: "production",
                timestamp: new Date().toISOString(),
                settings: {
                    cache_enabled: true,
                    timeout_ms: 5000
                },
                notes: "Generated by Muhammad Khan's Dev Assistant."
            };

            const jsonContent = JSON.stringify(data, null, 4); // Pretty print JSON

            downloadFile(
                'config_2024.json', 
                jsonContent, 
                'application/json'
            );

            console.log(`Download initiated for config_2024.json (${jsonContent.length} bytes)`);
        });
    </script>
</body>
</html>
